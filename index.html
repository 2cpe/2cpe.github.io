<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Wedding Invitation QR Code Generator">
    <title>Wedding Invitation QR Code</title>
    <link rel="stylesheet" href="style.css">
    <script>
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('Error: ' + msg + '\nURL: ' + url + '\nLine: ' + lineNo);
            return false;
        };

        document.addEventListener('DOMContentLoaded', function() {
            // Mouse leave event
            document.addEventListener("mouseleave", () => {
                document.body.style.filter = "blur(10px)";
                alert("Mouse has left the page. Content is hidden.");
            });

            // Watermark
            const watermark = document.createElement("div");
            watermark.style.position = "fixed";
            watermark.style.top = "10px";
            watermark.style.left = "10px";
            watermark.style.color = "rgba(0, 0, 0, 0.1)";
            watermark.style.fontSize = "24px";
            watermark.style.zIndex = "1000";
            watermark.style.pointerEvents = "none";
            watermark.innerText = `Watermark: ${new Date().toLocaleString()}`;
            document.body.appendChild(watermark);

            // Developer tools detection
            const element = new Image();
            Object.defineProperty(element, 'id', {
                get: function() {
                    alert("Developer tools are not allowed.");
                    document.body.innerHTML = "";
                }
            });
            console.log(element);

            // iOS Screen Recording & Screenshot Detection
            let hidden, visibilityChange;
            if (typeof document.hidden !== "undefined") {
                hidden = "hidden";
                visibilityChange = "visibilitychange";
            }

            // Detect page visibility change (potential screenshot or screen recording)
            document.addEventListener(visibilityChange, function() {
                if (document.hidden) {
                    document.body.style.filter = "blur(20px)";
                    alert("Content protection activated!");
                } else {
                    document.body.style.filter = "none";
                }
            }, false);

            // iOS specific detection
            window.addEventListener('focusout', function() {
                // This triggers when control center is opened (potential screen recording)
                document.body.style.filter = "blur(20px)";
                alert("Screen recording detection activated!");
            });

            window.addEventListener('focusin', function() {
                document.body.style.filter = "none";
            });

            // Detect screenshot attempt using gesture events
            let touchStartTime = 0;
            let touchEndTime = 0;

            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) {
                    touchStartTime = new Date().getTime();
                }
            });

            document.addEventListener('touchend', function() {
                touchEndTime = new Date().getTime();
                if (touchEndTime - touchStartTime < 100) {
                    // Potential screenshot gesture detected
                    document.body.style.filter = "blur(20px)";
                    alert("Screenshot attempt detected!");
                    setTimeout(() => {
                        document.body.style.filter = "none";
                    }, 1000);
                }
            });

            // Additional protection
            const preventActions = function(e) {
                e.preventDefault();
                alert("This action is not allowed!");
            };

            // Prevent context menu
            document.addEventListener('contextmenu', preventActions);

            // Prevent selection
            document.addEventListener('selectstart', preventActions);

            // Prevent touch gestures
            document.addEventListener('touchmove', function(e) {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });

            // Add visual watermark with timestamp
            function updateWatermark() {
                const watermark = document.querySelector('.watermark') || document.createElement("div");
                watermark.className = 'watermark';
                watermark.style.position = "fixed";
                watermark.style.top = "50%";
                watermark.style.left = "50%";
                watermark.style.transform = "translate(-50%, -50%) rotate(-45deg)";
                watermark.style.color = "rgba(0, 0, 0, 0.1)";
                watermark.style.fontSize = "20px";
                watermark.style.whiteSpace = "nowrap";
                watermark.style.pointerEvents = "none";
                watermark.style.zIndex = "9999";
                watermark.style.userSelect = "none";
                watermark.innerText = `Protected Content - ${new Date().toLocaleString()}`;
                document.body.appendChild(watermark);
            }

            // Update watermark every second
            setInterval(updateWatermark, 1000);
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        /* Add these styles to prevent screenshots */
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        .protected-content {
            position: relative;
            z-index: 1;
        }

        @media screen and (min-width: 0\0) {
            /* IE9+ CSS */
            body {
                background-attachment: fixed;
            }
        }

        @supports (-webkit-touch-callout: none) {
            /* iOS-specific styles */
            body {
                -webkit-touch-callout: none;
            }
        }
    </style>
</head>
<body>
    <noscript>
        <div style="color: red; text-align: center; padding: 20px;">
            Please enable JavaScript to view this wedding invitation.
        </div>
    </noscript>
    <div class="container">
        <div class="invitation-card">
            <h1>Our Wedding Invitation</h1>
            <div id="qrcode"></div>
            <div class="details">
                <p class="names">John & Jane</p>
                <p class="date">Date: DD/MM/YYYY</p>
                <p class="venue">Venue: Your Wedding Venue</p>
            </div>
            
            <div class="attendance-form">
                <h2>RSVP</h2>
                <input type="text" id="guestName" placeholder="Enter your name" class="input-field">
                <div class="button-group">
                    <button id="confirmYes" class="confirm-button confirm-yes">✓ I'll Attend</button>
                    <button id="confirmNo" class="confirm-button confirm-no">✗ Can't Attend</button>
                </div>
            </div>

            <div class="guest-list">
                <h3>Guest List</h3>
                <div id="attendeesList"></div>
            </div>

            <div id="status-message"></div>
            <button id="resetButton" class="reset-button">Reset Device Access</button>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html> 
